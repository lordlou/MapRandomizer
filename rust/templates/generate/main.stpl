<!DOCTYPE html>
<html lang="en-US">
    <head>
    <% include!("../common/header.stpl"); %>
    <meta charset="UTF-8" />
    <title>Super Metroid Map Rando - Generate</title>
    <style> 
    input[type=submit] {
    padding: 12px 12px;
    box-sizing: border-box;
    }
    </style>
    </head>
    <body>
    <% include!("../common/navbar.stpl"); %>
    <script>
    document.getElementById("navigation-generate").classList.add("active");
    </script>
    <div class="container col-xl-10 col-xxl-8">
        <h3 class="mt-3 mb-2">Generate Game</h3>
        <form id="main-form" method="POST" enctype="multipart/form-data" action="/randomize" onchange="saveForm(this)"  onsubmit="prepareSubmit()">
            <div class="form-group row">
                <label class="col-lg-3 col-form-label my-2" for="rom"><% include!("help/rom.stpl"); %>Input ROM</label>
                <input class="col-lg-9 form-control-file my-3" type="file" id="vanillaRom" name="rom"
                onchange="saveROM(this, 'vanilla')">
            </div>
        
            <div class="form-group row">
                <div class="col-lg-3 my-2">
                    <% include!("help/skill.stpl"); %>
                    <label for="preset">Skill assumptions</label>
                </div>
                <div class="col-lg-9 btn-group my-2" role="group">
                <% for (i, p) in preset_data.iter().enumerate() { 
                    let name = &p.preset.name;
                    let name_no_space = &p.preset.name.replace(" ", "");
                    let checked = if i == 0 { "checked" } else { "" }; 
                    %>
                    <input type="radio" class="btn-check" name="preset" value="<%- name %>"
                        id="preset<%- name_no_space%>" autocomplete="off" onclick="presetChanged()" <%- checked %>>
                    <label class="btn btn-outline-primary" for="preset<%- name_no_space %>"><%= name %></label>
                <% } %>
                 </div>
            </div>
            
            <% include!("skill_assumptions.stpl"); %>

            <div class="form-group row">
                <div class="col-lg-3 my-2">
                    <% include!("help/progression.stpl"); %>
                    <label for="preset">Item progression</label>
                </div>
                <div class="col-lg-5 btn-group my-2" role="group">
                    <input type="radio" class="btn-check" name="item_progression_preset" value="Quick"
                        id="itemProgressionPresetQuick" autocomplete="off" 
                        onclick="itemProgressionPresetChanged()" checked>
                    <label class="btn btn-outline-primary" for="itemProgressionPresetQuick">Quick</label>

                    <input type="radio" class="btn-check" name="item_progression_preset" value="Standard"
                        id="itemProgressionPresetStandard" autocomplete="off" 
                        onclick="itemProgressionPresetChanged()">
                    <label class="btn btn-outline-primary" for="itemProgressionPresetStandard">Standard</label>

                    <input type="radio" class="btn-check" name="item_progression_preset" value="Challenge"
                        id="itemProgressionPresetChallenge" autocomplete="off" 
                        onclick="itemProgressionPresetChanged()">
                    <label class="btn btn-outline-primary" for="itemProgressionPresetChallenge">Challenge</label>
                 </div>
            </div>
            <div class="accordion my-2" id="accordionItemPriority">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseItemPriority">
                        Customize item progression
                        </button>
                    </h2>
                    <div id="collapseItemPriority" class="accordion-collapse collapse m-2">
                        <% include!("item_progression.stpl"); %>
                    </div>
                </div>
            </div>

            <% include!("quality_of_life.stpl"); %>

            <div class="form-group row">
                <div class="col-lg-3 my-2">
                    <% include!("help/objectives.stpl"); %>
                    <label for="objective">Objectives</label>
                </div>
                <div class="col-lg-5 btn-group my-2" role="group">
                <% for (i, name) in objectives.iter().enumerate() { 
                    let name_no_space = &name.replace(" ", "");
                    let checked = if i == 0 { "checked" } else { "" }; 
                    %>
                    <input type="radio" class="btn-check" name="objectives" value="<%- name %>"
                        id="objectives<%- name_no_space%>" autocomplete="off" <%- checked %>>
                    <label class="btn btn-outline-primary" for="objectives<%- name_no_space %>"><%= name %></label>
                <% } %>
                </div>
            </div>            

            <div class="accordion my-2" id="accordionGameVariations">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseGameVariations">
                        Game variations
                        </button>
                    </h2>
                    <div id="collapseGameVariations" class="accordion-collapse collapse m-2" onchange="gameVariationChanged()">
                        <% include!("game_variations.stpl"); %>
                    </div>
                </div>
            </div>

            <div class="form-group row">
                <div class="col-lg-3 my-2">
                    <% include!("help/race.stpl"); %>
                    <label for="preset">Race mode</label>
                </div>
                <div class="col-lg-2 btn-group my-2" role="group">
                    <input type="radio" class="btn-check" name="race_mode" id="raceModeNo" value="No" checked=true>
                    <label class="btn btn-outline-primary" for="raceModeNo">No</label>
                    <input type="radio" class="btn-check" name="race_mode" id="raceModeYes" value="Yes">
                    <label class="btn btn-outline-primary" for="raceModeYes">Yes</label>
                </div>
            </div>

            <div class="form-group row">
                <div class="col-lg-3 my-2">
                    <% include!("help/seed.stpl"); %>
                    <label for="preset">Random seed</label>
                </div>
                <div class="col-lg-3 my-2">
                <input type="text" class="form-control" name="random_seed" id="randomSeed" value="">
                </div>
            </div>
            <input type="hidden" id="spoilerToken" name="spoiler_token">
            <div class="form-group row">
                <div class="col-lg-3 my-2">
                    <input type="submit" class="btn btn-primary" value="Generate Game">
                </div>
            </div>
        </form>
    </div>
    <% include!("scripts.stpl"); %>
    </body>
</html>