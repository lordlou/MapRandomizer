<!DOCTYPE html>
<html lang="en-US">
    <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Super Metroid, Map Randomizer, Map Rando, Map, Randomizer">
    <title>Super Metroid Map Rando</title>
    <link rel="shortcut icon" type="image/x-icon" href="/static/favicon.ico">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.4/font/bootstrap-icons.css">
    <style> 
    input[type=submit] {
    padding: 12px 12px;
    box-sizing: border-box;
    }
    </style>
    <script src="static/colorMode.js"></script>
    </head>
    <body>
    <div class="container">
        <div class="row">
            <div class="col-3">
            </div>
            <div class="col-6 text-center my-2">
                <img src="/static/WebTitle.png" alt="Super Metroid Map Rando" style="width: 75%">
            </div>
            <div class="col-3" align=right>
                <small>Version: <%= version %></small>
            </div>
        </div>
        <form id="main-form" method="POST" enctype="multipart/form-data" action="/randomize" onchange="saveForm(this)"  onsubmit="prepareSubmit()">
            <div class="form-group row">
                <label class="col-lg-3 col-form-label my-2" for="rom"><% include!("help/rom.stpl"); %>Input ROM</label>
                <input class="col-lg-9 form-control-file my-3" type="file" id="vanillaRom" name="rom"
                onchange="saveROM(this, 'vanilla')">
            </div>
        
            <div class="form-group row">
                <div class="col-lg-3 my-2">
                    <% include!("help/skill.stpl"); %>
                    <label for="preset">Skill assumptions</label>
                </div>
                <div class="col-lg-9 btn-group my-2" role="group">
                <% for (i, p) in preset_data.iter().enumerate() { 
                    let name = &p.preset.name;
                    let name_no_space = &p.preset.name.replace(" ", "");
                    let checked = if i == 0 { "checked" } else { "" }; 
                    %>
                    <input type="radio" class="btn-check" name="preset" value="<%- name %>"
                        id="preset<%- name_no_space%>" autocomplete="off" onclick="presetChanged()" <%- checked %>>
                    <label class="btn btn-outline-primary" for="preset<%- name_no_space %>"><%= name %></label>
                <% } %>
                 </div>
            </div>
            
            <% include!("skill_assumptions.stpl"); %>

            <div class="form-group row">
                <div class="col-lg-3 my-2">
                    <% include!("help/progression.stpl"); %>
                    <label for="preset">Item progression</label>
                </div>
                <div class="col-lg-5 btn-group my-2" role="group">
                    <input type="radio" class="btn-check" name="item_progression_preset" value="Quick"
                        id="itemProgressionPresetQuick" autocomplete="off" 
                        onclick="itemProgressionPresetChanged()" checked>
                    <label class="btn btn-outline-primary" for="itemProgressionPresetQuick">Quick</label>

                    <input type="radio" class="btn-check" name="item_progression_preset" value="Standard"
                        id="itemProgressionPresetStandard" autocomplete="off" 
                        onclick="itemProgressionPresetChanged()">
                    <label class="btn btn-outline-primary" for="itemProgressionPresetStandard">Standard</label>

                    <input type="radio" class="btn-check" name="item_progression_preset" value="Challenge"
                        id="itemProgressionPresetChallenge" autocomplete="off" 
                        onclick="itemProgressionPresetChanged()">
                    <label class="btn btn-outline-primary" for="itemProgressionPresetChallenge">Challenge</label>
                 </div>
            </div>
            <div class="accordion my-2" id="accordionItemPriority">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseItemPriority">
                        Customize item progression
                        </button>
                    </h2>
                    <div id="collapseItemPriority" class="accordion-collapse collapse m-2">
                        <% include!("item_progression.stpl"); %>
                    </div>
                </div>
            </div>

            <% include!("quality_of_life.stpl"); %>

            <div class="form-group row">
                <div class="col-lg-3 my-2">
                    <% include!("help/objectives.stpl"); %>
                    <label for="objective">Objectives</label>
                </div>
                <div class="col-lg-5 btn-group my-2" role="group">
                <% for (i, name) in objectives.iter().enumerate() { 
                    let name_no_space = &name.replace(" ", "");
                    let checked = if i == 0 { "checked" } else { "" }; 
                    %>
                    <input type="radio" class="btn-check" name="objectives" value="<%- name %>"
                        id="objectives<%- name_no_space%>" autocomplete="off" <%- checked %>>
                    <label class="btn btn-outline-primary" for="objectives<%- name_no_space %>"><%= name %></label>
                <% } %>
                </div>
            </div>            

            <div class="accordion my-2" id="accordionGameVariations">
                <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseGameVariations">
                        Game variations
                        </button>
                    </h2>
                    <div id="collapseGameVariations" class="accordion-collapse collapse m-2" onchange="gameVariationChanged()">
                        <% include!("game_variations.stpl"); %>
                    </div>
                </div>
            </div>

            <div class="form-group row">
                <div class="col-lg-3 my-2">
                    <% include!("help/race.stpl"); %>
                    <label for="preset">Race mode</label>
                </div>
                <div class="col-lg-2 btn-group my-2" role="group">
                    <input type="radio" class="btn-check" name="race_mode" id="raceModeNo" value="No" checked=true>
                    <label class="btn btn-outline-primary" for="raceModeNo">No</label>
                    <input type="radio" class="btn-check" name="race_mode" id="raceModeYes" value="Yes">
                    <label class="btn btn-outline-primary" for="raceModeYes">Yes</label>
                </div>
            </div>

            <div class="form-group row">
                <div class="col-lg-3 my-2">
                    <% include!("help/seed.stpl"); %>
                    <label for="preset">Random seed</label>
                </div>
                <div class="col-lg-3 my-2">
                <input type="text" class="form-control" name="random_seed" id="randomSeed" value="">
                </div>
            </div>
            <input type="hidden" id="spoilerToken" name="spoiler_token">
            <div class="form-group row">
                <div class="col-lg-3 my-2">
                    <input type="submit" class="btn btn-primary" value="Randomize Game">
                </div>
            </div>
        </form>
        <small><strong>Note</strong>: This is still under heavy development, so bugs are expected. If you encounter a problem, 
        feedback is welcome on <a href="https://github.com/blkerby/MapRandomizer/issues">GitHub issues</a>. 
        Also feel free to stop by the <a href="https://discord.gg/Gc99YV2ZcB">Discord</a>: let us know if you
        find a cool seed (or a broken seed), if you have questions or ideas for future development, or if you're 
        streaming the game!</small>
        
        <div class="row my-2">
            <div class="col-sm-12">
                <div class="card">
                    <div class="card-header">Change log</div>
                    <div class="card-body">
                        <% include!("changelog.stpl"); %>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <% include!("scripts.stpl"); %>
    </body>
</html>